# 项目总结

问题1 全局变量只声明没有定义…

![Untitled](%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93%203a5e49fd4c15450184c59a5c6654c808/Untitled.png)

问题2 哈希模块和 线程池模块同时定义客户端 信息导致定义重复

![Untitled](%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93%203a5e49fd4c15450184c59a5c6654c808/Untitled%201.png)

问题3缓冲区问题

![Untitled](%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93%203a5e49fd4c15450184c59a5c6654c808/Untitled%202.png)

问题4服务器 客户端使用相同共享内存id但是映射时大小参数不一致 导致写入数据异常..段错误

问题5 服务器客户端 创建了不同的共享内存id? 路径不同导致  由于定义的是相对路径 “.” 而客户端和服务器所在目录不同..程序运行路径也就不同.

![Untitled](%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93%203a5e49fd4c15450184c59a5c6654c808/Untitled%203.png)

**问题6   如果将申请的共享空间映射到结构体上  那么结构体中不要定义指针类型变量 因为共享内存映射到不同的进程 地址是不同的   所以一个进程使用另一个进程的地址没有任何意义 引发了段错误!**

取消数据区指针

![Untitled](%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93%203a5e49fd4c15450184c59a5c6654c808/Untitled%204.png)

**问题7 消息队列创建失败? 路径问题**

问题8 写入共享内存后 没有被读取数据 同时 发布端上线 段错误 **先在结构体头的指针类型基础上偏移 然后强转为字节 在偏移到读写数据区!**

![Untitled](%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93%203a5e49fd4c15450184c59a5c6654c808/Untitled%205.png)

问题9哈希表没有插入数据..

**问题10.踩了一个巨坑 请记住 消息队列的消息结构体必须严格按照手册格式(前后定位了不下5个小时以上….丢)**

```c
struct msgbuf {
long mtype;       /* message type, must be > 0 */
char mtext[1];    /* message data */
};
```

完成!!

![Untitled](%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93%203a5e49fd4c15450184c59a5c6654c808/Untitled%206.png)

![Untitled](%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93%203a5e49fd4c15450184c59a5c6654c808/Untitled%207.png)